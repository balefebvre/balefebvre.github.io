language: python  # i.e. language support to enable
os: linux  # i.e. build environment operating system
dist: xenial  # i.e. build environment distribution (Ubuntu Xenial 16.04)
arch: amd64  # i.e. build environment architecture

python: 3.7

branches:
  only:
    - servant  # i.e. avoid the website to be updated by commits outside of the `servant` branch

install:
  # - pip install -r requirements.txt
  - pip install pelican
  - pip install markdown

script:
  # - pytest
  - pelican content

# Configuration to deploy static Pelican website to GitHub Pages (c.f. https://docs.travis-ci.com/user/deployment/pages/):
deploy:
  provider: pages
  # cleanup: true  # avoid deleting all the files creating during the build (which will probably delete what is trying to be uploaded)  #TODO remove (failure)?
  token: $USER_GITHUB_PAGES_TOKEN  # set in the settings page of your repository, as a secure variable
  edge: true  # opt in to dpl v2
  # edge:
  #   source: travis-ci/dpl
  #   branch: master
  on:
    branch: servant  # i.e. target branch used for deployment and only this specific purpose
  local_dir: output  # i.e. directory to push to GitHub Pages
  repo: balefebvre/balefebvre.github.io  # i.e. repo slug
  target_branch: master  # i.e. branch to push `local_dir` contents to
  keep_history: true  # disable the "force push" behavior to avoid overwriting the history on the target branch  # i.e. create incremental commit instead of doing push force
  # fqdn:  # i.e. set a custom domain for the website
  # project_name:  # Defaults to value of `fqdn` or repo slug, used for metadata.
  # email:  # Optional, committer info, defaults to `deploy@travis-ci.org`.
  # name:  # Optional, committer, defaults to `Deployment Bot`.
  # commiter_from_gh:  # Optional, defaults to `false`. Allows you to use the token’s owner name and email for commit. Overrides `email` and `name` options.
  allow_empty_commit: true  # Optional, defaults to `false`. Enabled if only `keep_history` is `true`.
  # github_url:  # Optional, the URL of the self-hosted GitHub enterprise, defaults to `github.com`.
  verbose: true  # Optional, be verbose about internal steps, defaults to `false`.
  # deployment_file: true  # Optional, defaults to `false`, enables creation of deployment-info files.
  strategy: git  # GitHub Pages deployment strategy — type: string, default: `git`, known values: `api`, `git`
